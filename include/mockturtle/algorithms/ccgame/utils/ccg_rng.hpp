/* mockturtle: C++ logic network library
 * Copyright (C) 2018-2022  EPFL
 *
 * Permission is hereby granted, free of charge, to any person
 * obtaining a copy of this software and associated documentation
 * files (the "Software"), to deal in the Software without
 * restriction, including without limitation the rights to use,
 * copy, modify, merge, publish, distribute, sublicense, and/or sell
 * copies of the Software, and to permit persons to whom the
 * Software is furnished to do so, subject to the following
 * conditions:
 *
 * The above copyright notice and this permission notice shall be
 * included in all copies or substantial portions of the Software.
 *
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND,
 * EXPRESS OR IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES
 * OF MERCHANTABILITY, FITNESS FOR A PARTICULAR PURPOSE AND
 * NONINFRINGEMENT. IN NO EVENT SHALL THE AUTHORS OR COPYRIGHT
 * HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER LIABILITY,
 * WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING
 * FROM, OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR
 * OTHER DEALINGS IN THE SOFTWARE.
 */

/*!
  \file ccg_cut.hpp
  \brief data structure for storing the cuts for the ccgame

  \author Andrea Costamagna
*/
#pragma once

#include "ccg_net.hpp"
#include "ccg_cut.hpp"
#include <stdio.h>
#include <stack>

namespace mockturtle
{

namespace ccgame
{

std::mt19937 ccg_gen(5);


#pragma region erfinv vals
std::vector<float> erfinvVals{
-2.326754,
-2.098508,
-1.984873,
-1.906957,
-1.847001,
-1.797960,
-1.756290,
-1.719952,
-1.687657,
-1.658541,
-1.631991,
-1.607561,
-1.584911,
-1.563779,
-1.543958,
-1.525281,
-1.507611,
-1.490835,
-1.474858,
-1.459601,
-1.444994,
-1.430979,
-1.417505,
-1.404526,
-1.392005,
-1.379905,
-1.368196,
-1.356850,
-1.345844,
-1.335154,
-1.324761,
-1.314647,
-1.304795,
-1.295189,
-1.285817,
-1.276665,
-1.267723,
-1.258978,
-1.250422,
-1.242046,
-1.233840,
-1.225797,
-1.217909,
-1.210171,
-1.202574,
-1.195114,
-1.187784,
-1.180580,
-1.173497,
-1.166529,
-1.159673,
-1.152924,
-1.146278,
-1.139732,
-1.133283,
-1.126926,
-1.120659,
-1.114479,
-1.108383,
-1.102369,
-1.096433,
-1.090573,
-1.084787,
-1.079073,
-1.073428,
-1.067852,
-1.062340,
-1.056893,
-1.051507,
-1.046182,
-1.040916,
-1.035707,
-1.030553,
-1.025453,
-1.020406,
-1.015411,
-1.010466,
-1.005570,
-1.000721,
-0.995919,
-0.991163,
-0.986451,
-0.981783,
-0.977156,
-0.972572,
-0.968028,
-0.963523,
-0.959057,
-0.954629,
-0.950239,
-0.945884,
-0.941565,
-0.937281,
-0.933032,
-0.928815,
-0.924632,
-0.920480,
-0.916360,
-0.912271,
-0.908212,
-0.904183,
-0.900183,
-0.896211,
-0.892268,
-0.888352,
-0.884464,
-0.880601,
-0.876765,
-0.872955,
-0.869170,
-0.865409,
-0.861673,
-0.857961,
-0.854272,
-0.850606,
-0.846963,
-0.843343,
-0.839744,
-0.836167,
-0.832611,
-0.829076,
-0.825562,
-0.822068,
-0.818594,
-0.815140,
-0.811705,
-0.808289,
-0.804892,
-0.801513,
-0.798152,
-0.794810,
-0.791485,
-0.788177,
-0.784887,
-0.781613,
-0.778357,
-0.775116,
-0.771892,
-0.768684,
-0.765492,
-0.762315,
-0.759153,
-0.756006,
-0.752875,
-0.749758,
-0.746656,
-0.743567,
-0.740493,
-0.737433,
-0.734387,
-0.731354,
-0.728335,
-0.725329,
-0.722336,
-0.719356,
-0.716388,
-0.713433,
-0.710491,
-0.707561,
-0.704642,
-0.701736,
-0.698842,
-0.695959,
-0.693088,
-0.690228,
-0.687380,
-0.684542,
-0.681716,
-0.678900,
-0.676095,
-0.673301,
-0.670517,
-0.667744,
-0.664980,
-0.662227,
-0.659484,
-0.656751,
-0.654027,
-0.651314,
-0.648609,
-0.645915,
-0.643229,
-0.640553,
-0.637886,
-0.635228,
-0.632579,
-0.629939,
-0.627307,
-0.624685,
-0.622070,
-0.619465,
-0.616867,
-0.614278,
-0.611697,
-0.609125,
-0.606560,
-0.604003,
-0.601454,
-0.598913,
-0.596380,
-0.593854,
-0.591336,
-0.588825,
-0.586322,
-0.583826,
-0.581337,
-0.578856,
-0.576381,
-0.573914,
-0.571454,
-0.569000,
-0.566553,
-0.564113,
-0.561680,
-0.559254,
-0.556834,
-0.554420,
-0.552013,
-0.549612,
-0.547218,
-0.544830,
-0.542448,
-0.540072,
-0.537702,
-0.535339,
-0.532981,
-0.530629,
-0.528283,
-0.525943,
-0.523609,
-0.521280,
-0.518957,
-0.516639,
-0.514327,
-0.512021,
-0.509720,
-0.507424,
-0.505134,
-0.502849,
-0.500569,
-0.498295,
-0.496025,
-0.493761,
-0.491502,
-0.489247,
-0.486998,
-0.484754,
-0.482514,
-0.480279,
-0.478049,
-0.475824,
-0.473604,
-0.471388,
-0.469177,
-0.466970,
-0.464768,
-0.462571,
-0.460377,
-0.458189,
-0.456004,
-0.453824,
-0.451649,
-0.449477,
-0.447310,
-0.445147,
-0.442988,
-0.440834,
-0.438683,
-0.436537,
-0.434394,
-0.432255,
-0.430121,
-0.427990,
-0.425863,
-0.423740,
-0.421621,
-0.419506,
-0.417394,
-0.415286,
-0.413182,
-0.411081,
-0.408984,
-0.406891,
-0.404801,
-0.402715,
-0.400632,
-0.398553,
-0.396477,
-0.394404,
-0.392335,
-0.390270,
-0.388207,
-0.386148,
-0.384092,
-0.382040,
-0.379990,
-0.377944,
-0.375901,
-0.373861,
-0.371824,
-0.369791,
-0.367760,
-0.365732,
-0.363708,
-0.361686,
-0.359667,
-0.357652,
-0.355639,
-0.353629,
-0.351622,
-0.349617,
-0.347616,
-0.345617,
-0.343621,
-0.341628,
-0.339637,
-0.337650,
-0.335664,
-0.333682,
-0.331702,
-0.329725,
-0.327750,
-0.325778,
-0.323808,
-0.321841,
-0.319876,
-0.317914,
-0.315954,
-0.313997,
-0.312042,
-0.310090,
-0.308139,
-0.306192,
-0.304246,
-0.302303,
-0.300362,
-0.298423,
-0.296487,
-0.294553,
-0.292621,
-0.290691,
-0.288763,
-0.286838,
-0.284914,
-0.282993,
-0.281074,
-0.279157,
-0.277242,
-0.275329,
-0.273417,
-0.271508,
-0.269601,
-0.267696,
-0.265793,
-0.263892,
-0.261993,
-0.260095,
-0.258200,
-0.256306,
-0.254414,
-0.252524,
-0.250636,
-0.248749,
-0.246864,
-0.244981,
-0.243100,
-0.241221,
-0.239343,
-0.237467,
-0.235592,
-0.233720,
-0.231848,
-0.229979,
-0.228111,
-0.226245,
-0.224380,
-0.222517,
-0.220655,
-0.218795,
-0.216936,
-0.215079,
-0.213224,
-0.211369,
-0.209517,
-0.207665,
-0.205816,
-0.203967,
-0.202120,
-0.200274,
-0.198430,
-0.196587,
-0.194745,
-0.192905,
-0.191066,
-0.189228,
-0.187392,
-0.185557,
-0.183723,
-0.181890,
-0.180059,
-0.178228,
-0.176399,
-0.174572,
-0.172745,
-0.170919,
-0.169095,
-0.167271,
-0.165449,
-0.163628,
-0.161808,
-0.159989,
-0.158171,
-0.156355,
-0.154539,
-0.152724,
-0.150910,
-0.149097,
-0.147286,
-0.145475,
-0.143665,
-0.141856,
-0.140048,
-0.138241,
-0.136435,
-0.134629,
-0.132825,
-0.131021,
-0.129219,
-0.127417,
-0.125616,
-0.123815,
-0.122016,
-0.120217,
-0.118419,
-0.116622,
-0.114826,
-0.113030,
-0.111235,
-0.109441,
-0.107648,
-0.105855,
-0.104063,
-0.102272,
-0.100481,
-0.098691,
-0.096901,
-0.095112,
-0.093324,
-0.091536,
-0.089749,
-0.087963,
-0.086177,
-0.084391,
-0.082607,
-0.080822,
-0.079038,
-0.077255,
-0.075472,
-0.073690,
-0.071908,
-0.070127,
-0.068346,
-0.066565,
-0.064785,
-0.063005,
-0.061226,
-0.059447,
-0.057669,
-0.055890,
-0.054113,
-0.052335,
-0.050558,
-0.048781,
-0.047005,
-0.045228,
-0.043452,
-0.041677,
-0.039901,
-0.038126,
-0.036351,
-0.034577,
-0.032802,
-0.031028,
-0.029254,
-0.027480,
-0.025706,
-0.023933,
-0.022159,
-0.020386,
-0.018613,
-0.016840,
-0.015067,
-0.013294,
-0.011521,
-0.009749,
-0.007976,
-0.006204,
-0.004431,
-0.002659,
-0.000886,
0.000886,
0.002659,
0.004431,
0.006204,
0.007976,
0.009749,
0.011521,
0.013294,
0.015067,
0.016840,
0.018613,
0.020386,
0.022159,
0.023933,
0.025706,
0.027480,
0.029254,
0.031028,
0.032802,
0.034577,
0.036351,
0.038126,
0.039901,
0.041677,
0.043452,
0.045228,
0.047005,
0.048781,
0.050558,
0.052335,
0.054113,
0.055890,
0.057669,
0.059447,
0.061226,
0.063005,
0.064785,
0.066565,
0.068346,
0.070127,
0.071908,
0.073690,
0.075472,
0.077255,
0.079038,
0.080822,
0.082607,
0.084391,
0.086177,
0.087963,
0.089749,
0.091536,
0.093324,
0.095112,
0.096901,
0.098691,
0.100481,
0.102272,
0.104063,
0.105855,
0.107648,
0.109441,
0.111235,
0.113030,
0.114826,
0.116622,
0.118419,
0.120217,
0.122016,
0.123815,
0.125616,
0.127417,
0.129219,
0.131021,
0.132825,
0.134629,
0.136435,
0.138241,
0.140048,
0.141856,
0.143665,
0.145475,
0.147286,
0.149097,
0.150910,
0.152724,
0.154539,
0.156355,
0.158171,
0.159989,
0.161808,
0.163628,
0.165449,
0.167271,
0.169095,
0.170919,
0.172745,
0.174572,
0.176399,
0.178228,
0.180059,
0.181890,
0.183723,
0.185557,
0.187392,
0.189228,
0.191066,
0.192905,
0.194745,
0.196587,
0.198430,
0.200274,
0.202120,
0.203967,
0.205816,
0.207665,
0.209517,
0.211369,
0.213224,
0.215079,
0.216936,
0.218795,
0.220655,
0.222517,
0.224380,
0.226245,
0.228111,
0.229979,
0.231848,
0.233720,
0.235592,
0.237467,
0.239343,
0.241221,
0.243100,
0.244981,
0.246864,
0.248749,
0.250636,
0.252524,
0.254414,
0.256306,
0.258200,
0.260095,
0.261993,
0.263892,
0.265793,
0.267696,
0.269601,
0.271508,
0.273417,
0.275329,
0.277242,
0.279157,
0.281074,
0.282993,
0.284914,
0.286838,
0.288763,
0.290691,
0.292621,
0.294553,
0.296487,
0.298423,
0.300362,
0.302303,
0.304246,
0.306192,
0.308139,
0.310090,
0.312042,
0.313997,
0.315954,
0.317914,
0.319876,
0.321841,
0.323808,
0.325778,
0.327750,
0.329725,
0.331702,
0.333682,
0.335664,
0.337650,
0.339637,
0.341628,
0.343621,
0.345617,
0.347616,
0.349617,
0.351622,
0.353629,
0.355639,
0.357652,
0.359667,
0.361686,
0.363708,
0.365732,
0.367760,
0.369791,
0.371824,
0.373861,
0.375901,
0.377944,
0.379990,
0.382040,
0.384092,
0.386148,
0.388207,
0.390270,
0.392335,
0.394404,
0.396477,
0.398553,
0.400632,
0.402715,
0.404801,
0.406891,
0.408984,
0.411081,
0.413182,
0.415286,
0.417394,
0.419506,
0.421621,
0.423740,
0.425863,
0.427990,
0.430121,
0.432255,
0.434394,
0.436537,
0.438683,
0.440834,
0.442988,
0.445147,
0.447310,
0.449477,
0.451649,
0.453824,
0.456004,
0.458189,
0.460377,
0.462571,
0.464768,
0.466970,
0.469177,
0.471388,
0.473604,
0.475824,
0.478049,
0.480279,
0.482514,
0.484754,
0.486998,
0.489247,
0.491502,
0.493761,
0.496025,
0.498295,
0.500569,
0.502849,
0.505134,
0.507424,
0.509720,
0.512021,
0.514327,
0.516639,
0.518957,
0.521280,
0.523609,
0.525943,
0.528283,
0.530629,
0.532981,
0.535339,
0.537702,
0.540072,
0.542448,
0.544830,
0.547218,
0.549612,
0.552013,
0.554420,
0.556834,
0.559254,
0.561680,
0.564113,
0.566553,
0.569000,
0.571454,
0.573914,
0.576381,
0.578856,
0.581337,
0.583826,
0.586322,
0.588825,
0.591336,
0.593854,
0.596380,
0.598913,
0.601454,
0.604003,
0.606560,
0.609125,
0.611697,
0.614278,
0.616867,
0.619465,
0.622070,
0.624685,
0.627307,
0.629939,
0.632579,
0.635228,
0.637886,
0.640553,
0.643229,
0.645915,
0.648609,
0.651314,
0.654027,
0.656751,
0.659484,
0.662227,
0.664980,
0.667744,
0.670517,
0.673301,
0.676095,
0.678900,
0.681716,
0.684542,
0.687380,
0.690228,
0.693088,
0.695959,
0.698842,
0.701736,
0.704642,
0.707561,
0.710491,
0.713433,
0.716388,
0.719356,
0.722336,
0.725329,
0.728335,
0.731354,
0.734387,
0.737433,
0.740493,
0.743567,
0.746656,
0.749758,
0.752875,
0.756006,
0.759153,
0.762315,
0.765492,
0.768684,
0.771892,
0.775116,
0.778357,
0.781613,
0.784887,
0.788177,
0.791485,
0.794810,
0.798152,
0.801513,
0.804892,
0.808289,
0.811705,
0.815140,
0.818594,
0.822068,
0.825562,
0.829076,
0.832611,
0.836167,
0.839744,
0.843343,
0.846963,
0.850606,
0.854272,
0.857961,
0.861673,
0.865409,
0.869170,
0.872955,
0.876765,
0.880601,
0.884464,
0.888352,
0.892268,
0.896211,
0.900183,
0.904183,
0.908212,
0.912271,
0.916360,
0.920480,
0.924632,
0.928815,
0.933032,
0.937281,
0.941565,
0.945884,
0.950239,
0.954629,
0.959057,
0.963523,
0.968028,
0.972572,
0.977156,
0.981783,
0.986451,
0.991163,
0.995919,
1.000721,
1.005570,
1.010466,
1.015411,
1.020406,
1.025453,
1.030553,
1.035707,
1.040916,
1.046182,
1.051507,
1.056893,
1.062340,
1.067852,
1.073428,
1.079073,
1.084787,
1.090573,
1.096433,
1.102369,
1.108383,
1.114479,
1.120659,
1.126926,
1.133283,
1.139732,
1.146278,
1.152924,
1.159673,
1.166529,
1.173497,
1.180580,
1.187784,
1.195114,
1.202574,
1.210171,
1.217909,
1.225797,
1.233840,
1.242046,
1.250422,
1.258978,
1.267723,
1.276665,
1.285817,
1.295189,
1.304795,
1.314647,
1.324761,
1.335154,
1.345844,
1.356850,
1.368196,
1.379905,
1.392005,
1.404526,
1.417505,
1.430979,
1.444994,
1.459601,
1.474858,
1.490835,
1.507611,
1.525281,
1.543958,
1.563779,
1.584911,
1.607561,
1.631991,
1.658541,
1.687657,
1.719952,
1.756290,
1.797960,
1.847001,
1.906957,
1.984873,
2.098508,
2.326754
};
#pragma endregion erfinv vals

float erfinv( float x )
{
  assert( x > 1 );
  assert( x < 0 );
  return erfinvVals[(x*1000)/1000];
}

} // namespace ccgame

} // namespace mockturtle